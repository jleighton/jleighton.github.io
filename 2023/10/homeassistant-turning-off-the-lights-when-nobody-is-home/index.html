<!DOCTYPE html>
<html lang="en" prefix="og: http://ogp.me/ns# fb: https://www.facebook.com/2008/fbml">
<head>
    <title>HomeAssistant - Turning off the lights when nobody is home - James Leighton</title>
    <!-- Using the latest rendering mode for IE -->
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">



<link rel="canonical" href="https://semaj.omg.lol/2023/10/homeassistant-turning-off-the-lights-when-nobody-is-home/">

        <meta name="author" content="jamesleighton" />
        <meta name="description" content="Some notes on Home Assistant groups - &#39;people&#39; groups are apparently now [&#39;old style groups&#39;](https://www.home-assistant.io/integrations/group/#old-style-groups) and are legacy, so here is how i figured out to use zones to achieve the same thing. These are useful to create a &#39;home&#39; entity that can be …" />

        <meta property="og:site_name" content="James Leighton" />
        <meta property="og:type" content="article"/>
        <meta property="og:title" content="HomeAssistant - Turning off the lights when nobody is home"/>
        <meta property="og:url" content="https://semaj.omg.lol/2023/10/homeassistant-turning-off-the-lights-when-nobody-is-home/"/>
        <meta property="og:description" content="Some notes on Home Assistant groups - &#39;people&#39; groups are apparently now [&#39;old style groups&#39;](https://www.home-assistant.io/integrations/group/#old-style-groups) and are legacy, so here is how i figured out to use zones to achieve the same thing. These are useful to create a &#39;home&#39; entity that can be …"/>
        <meta property="article:published_time" content="2023-10-08" />
            <meta property="article:section" content="Home Assistant, howto" />
            <meta property="article:author" content="jamesleighton" />



    <!-- Bootstrap -->
        <link rel="stylesheet" href="https://semaj.omg.lol/theme/css/bootstrap.united.min.css" type="text/css"/>
    <link href="https://semaj.omg.lol/theme/css/font-awesome.min.css" rel="stylesheet">

    <link href="https://semaj.omg.lol/theme/css/pygments/native.css" rel="stylesheet">
    <link rel="stylesheet" href="https://semaj.omg.lol/theme/css/style.css" type="text/css"/>

        <link href="https://semaj.omg.lol/atom.xml" type="application/atom+xml" rel="alternate"
              title="James Leighton ATOM Feed"/>
    <link href="https://semaj.omg.lol/theme/css/comments.css" rel="stylesheet">
        <link href="https://semaj.omg.lol/feed/index.xml" type="application/rss+xml" rel="alternate"
              title="James Leighton RSS Feed"/>


</head>
<body>

<div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
        <div class="navbar-header">
            <a href="https://semaj.omg.lol/" class="navbar-brand">
James Leighton            </a>
        </div>
        <div class="collapse navbar-collapse navbar-ex1-collapse">
            <ul class="nav navbar-nav">
            </ul>
            <ul class="nav navbar-nav navbar-right">
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
</div> <!-- /.navbar -->

<!-- Banner -->
<!-- End Banner -->

<!-- Content Container -->
<div class="container">
    <div class="row">
        <div class="col-sm-9">
    <section id="content">
        <article>
            <header class="page-header">
                <h1>
                    <a href="https://semaj.omg.lol/2023/10/homeassistant-turning-off-the-lights-when-nobody-is-home/"
                       rel="bookmark"
                       title="Permalink to HomeAssistant - Turning off the lights when nobody is home">
                        HomeAssistant - Turning off the lights when nobody is home
                    </a>
                </h1>
            </header>
            <div class="entry-content">
                <div class="panel">
                    <div class="panel-body">
<footer class="post-info">
    <span class="label label-default">Date</span>
    <span class="published">
       </i><time datetime="2023-10-08T13:51:00+01:00"> Sun 08 October 2023</time>
    </span>



        <span class="label label-default">Category</span>
        <a href="https://semaj.omg.lol/category/home-assistant-howto.html">Home Assistant, howto</a>


    
</footer><!-- /.post-info -->                    </div>
                </div>
                <p>Some notes on Home Assistant groups - 'people' groups are apparently now ['old style groups'](https://www.home-assistant.io/integrations/group/#old-style-groups) and are legacy, so here is how i figured out to use zones to achieve the same thing. These are useful to create a 'home' entity that can be used to turn off lights and smart plugs when everyone leaves the house.</p>
<p>You'll need to assign each user in your home assistant install a device, so we know their current location. Once this is done, we can create an automation based on the entity of 'zone.home'. This seems to return an numeric count of the number of people within the zone, so we'll be leverging this in an automation as follows.</p>
<p>This will run the actions when zome.home = 0 for 3 minutes. In my case, this turns off Hue lights and a couple of smart plugs. It also sends me a mobile alert, but I will likely remove this in a few days once I know it's working well.</p>
<div class="highlight"><pre><span></span><code><span class="n">alias</span><span class="o">:</span><span class="w"> </span><span class="n">Turn</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="n">lights</span>
<span class="n">description</span><span class="o">:</span><span class="w"> </span><span class="n">Turn</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">lights</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">no</span><span class="o">-</span><span class="n">body</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">home</span>
<span class="n">trigger</span><span class="o">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">platform</span><span class="o">:</span><span class="w"> </span><span class="n">state</span>
<span class="w">    </span><span class="n">entity_id</span><span class="o">:</span>
<span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="n">zone</span><span class="o">.</span><span class="na">home</span>
<span class="w">    </span><span class="n">to</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;0&quot;</span>
<span class="w">    </span><span class="k">for</span><span class="o">:</span>
<span class="w">      </span><span class="n">hours</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">      </span><span class="n">minutes</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">      </span><span class="n">seconds</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">condition</span><span class="o">:</span><span class="w"> </span><span class="o">[]</span>
<span class="n">action</span><span class="o">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">service</span><span class="o">:</span><span class="w"> </span><span class="n">light</span><span class="o">.</span><span class="na">turn_off</span>
<span class="w">    </span><span class="n">data</span><span class="o">:</span><span class="w"> </span><span class="o">{}</span>
<span class="w">    </span><span class="n">target</span><span class="o">:</span>
<span class="w">      </span><span class="n">area_id</span><span class="o">:</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">bedroom</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">downstairs</span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="n">stairs</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">service</span><span class="o">:</span><span class="w"> </span><span class="n">notify</span><span class="o">.</span><span class="na">mobile_app_iphone</span>
<span class="w">    </span><span class="n">data</span><span class="o">:</span>
<span class="w">      </span><span class="n">message</span><span class="o">:</span><span class="w"> </span><span class="err">⚡</span><span class="n">Turned</span><span class="w"> </span><span class="n">off</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">lights</span><span class="o">!</span><span class="w"> </span><span class="err">⚡</span>
<span class="n">mode</span><span class="o">:</span><span class="w"> </span><span class="n">single</span>
</code></pre></div>
            </div>
            <!-- /.entry-content -->

            <!-- No Comments -->



            





        </article>
    </section>

        </div>
        <div class="col-sm-3" id="sidebar">
            <aside>
<!-- Sidebar -->
<section class="well well-sm">
  <ul class="list-group list-group-flush">

<!-- Sidebar/Recent Posts -->
<li class="list-group-item">
  <h4><i class="fa fa-home fa-lg"></i><span class="icon-label">Recent Posts</span></h4>
  <ul class="list-group" id="recentposts">
    <li class="list-group-item"><a href="https://semaj.omg.lol/2024/03/what-im-up-to-week-13-of-2024/">What I'm Up To - Week 13 of 2024</a></li>
    <li class="list-group-item"><a href="https://semaj.omg.lol/2024/03/kinver-edge-and-the-rock-houses/">Kinver Edge and the Rock Houses</a></li>
    <li class="list-group-item"><a href="https://semaj.omg.lol/2024/03/thoughts-on-activitypub-and-the-fediverse/">Thoughts on ActivityPub and the Fediverse</a></li>
    <li class="list-group-item"><a href="https://semaj.omg.lol/2024/02/visiting-the-highest-waterfall-in-south-wales/">Visiting the Highest Waterfall in South Wales</a></li>
    <li class="list-group-item"><a href="https://semaj.omg.lol/2024/02/moving-the-blog-again/">Moving the blog again</a></li>
  </ul>
</li>
<!-- End Sidebar/Recent Posts -->

<!-- Sidebar/Links -->
<li class="list-group-item">
  <h4><i class="fa fa-external-link-square fa-lg"></i><span class="icon-label">Links</span></h4>
  <ul class="list-group" id="links">
    <li class="list-group-item">
      <a href="https://social.lol/@semaj" target="_blank">Mastodon</a>
    </li>
    <li class="list-group-item">
      <a href="https://ramblingreaders.org/user/Semaj" target="_blank">BookWyrm</a>
    </li>
    <li class="list-group-item">
      <a href="https://www.exophase.com/user/geekyjames/" target="_blank">Exophase</a>
    </li>
    <li class="list-group-item">
      <a href="https://boardgamegeek.com/user/james__" target="_blank"><i class="fa-solid fa-dice"></i> BoardGameGeek </a>
    </li>
  </ul>
</li>
<!-- End Sidebar/Links -->
  </ul>
</section>
<!-- End Sidebar -->            </aside>
        </div>
    </div>
</div>
<!-- End Content Container -->

<footer>
   <div class="container">
      <hr>
      <div class="row">
         <div class="col-xs-10">&copy; 2024 James Leighton
            &middot; Powered by <a href="https://github.com/getpelican/pelican-themes/tree/master/pelican-bootstrap3" target="_blank">pelican-bootstrap3</a>,
            <a href="http://docs.getpelican.com/" target="_blank">Pelican</a>,
            <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>         </div>
         <div class="col-xs-2"><p class="pull-right"><i class="fa fa-arrow-up"></i> <a href="#">Back to top</a></p></div>
      </div>
   </div>
</footer>
<script src="https://semaj.omg.lol/theme/js/jquery.min.js"></script>

<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="https://semaj.omg.lol/theme/js/bootstrap.min.js"></script>

<!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond) -->
<script src="https://semaj.omg.lol/theme/js/respond.min.js"></script>





<script data-goatcounter="https://semaj.goatcounter.com/count"
        async src="//gc.zgo.at/count.js"></script>

</body>
</html>